{"$schema":"https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#","contentVersion":"1.0.0.0","parameters":{"analytic-id":{"defaultValue":"ba67d4e8-16eb-404a-8d1a-3e036a1be1a2","metadata":{"description":"Unique id for the scheduled alert rule"},"minLength":1,"type":"string"},"workspace":{"type":"String"}},"resources":[{"id":"/subscriptions/1c61ccbf-70b3-45a3-a1fb-848ce46d70a6/resourceGroups/cxe-malowe/providers/Microsoft.OperationalInsights/workspaces/malowe2/providers/Microsoft.SecurityInsights/alertRules/ba67d4e8-16eb-404a-8d1a-3e036a1be1a2","name":"ba67d4e8-16eb-404a-8d1a-3e036a1be1a2","etag":"\"180058a4-0000-0100-0000-6234acd80000\"","type":"Microsoft.SecurityInsights/alertRules","kind":"Scheduled","properties":{"incidentConfiguration":{"createIncident":true,"groupingConfiguration":{"enabled":true,"reopenClosedIncident":false,"lookbackDuration":"PT5H","matchingMethod":"AllEntities","groupByEntities":[],"groupByAlertDetails":[],"groupByCustomDetails":[]}},"entityMappings":[{"entityType":"File","fieldMappings":[{"identifier":"Name","columnName":"modifiedTable"}]}],"queryFrequency":"PT5H","queryPeriod":"PT5H","triggerOperator":"GreaterThan","triggerThreshold":0,"eventGroupingSettings":{"aggregationKind":"SingleAlert"},"severity":"Medium","query":"AzureActivity\r\n//This is a sample comment\r\n| where TimeGenerated >= ago(90d)\r\n| where ActivityStatus has 'succeeded'\r\n| where OperationName has 'tables/write'\r\n| extend modifiedTable = extract('tables/(.*)', 1, _ResourceId)\r\n| summarize arg_max(TimeGenerated, *) by modifiedTable\r\n| project ['Last Modified Time'] = TimeGenerated, modifiedTable","suppressionDuration":"PT5H","suppressionEnabled":false,"tactics":["Impact"],"displayName":"Table Retention Modified","enabled":true,"description":"This is a test rule","alertRuleTemplateName":null,"lastModifiedUtc":"2022-03-18T16:01:27.7489616Z"}}]}